# Mongodb

## 基本概念
MongoDB是面向文档的数据库，不是关系型数据库。MongoDB的设计采用横向扩展的设计，能自动处理跨集群的数据和负载，自动中心分配文档，以及将用户的请求路由到正确的机器上。
> 基本的思路就是将原来"行"的概念换成更加灵活的"文档"模型。

独特功能：
- 索引：支持通用二级索引，切提供唯一索引、复合索引、地理空间索引及全文索引。
- 聚合：聚合管道。
- 特殊的集合类型：适用于将在某个时刻过期的数据，如会话(session)。支持固定大小的集合。
- 文件存储：支持一种非常易用的协议，用于存储大文件和文件元数据。

### 文档
多个键及其关联的值有序地放置在一起便是文档。


### 集合
集合就是一组文档。如果是MongoDB中的文档类似于关系型数据库的行，那么集合就如同表。
> 动态模式：一个集合里面的文档可以是各式各样的。正常会放相关类型的文档

子集合： 惯例是使用"." 分隔不同命名空间的子集合（没有任何特别的属性，只是用来命名区分）

### 数据类型
- null: 用于表示空值或者不存在的字段
- boolean
- 数值： 64位浮点数
- 字符串
- 日期：不存储时区
- 正则表达式
- 数组
- 内嵌文档：可嵌套其他文档
- 对象id：12字节的ID，唯一标识
- 二进制数据
- 代码：JavaScript代码

> 内嵌文档可以将比如地址文档嵌入到人员文档中
### _id 和 ObjectId

MongoDB中存储的文档必须有一个_id键，这个键的值可以是任何类型的，默认是个ObjectId对象。

ObjectId的组成：
- 4位时间戳
- 3位机器码: 主机唯一标识符,机器主机名的散列值
- 2位PID: 进程标识符
- 3位计数器：自动增加的计数器，确保相同进程同一秒产生的ObjectId不一样


**自动生成的_id**：通常在客户端由驱动程序完成，减轻了数据库的负担


### 索引介绍